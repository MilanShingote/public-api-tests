import pytest
from clients.countries_client import CountriesClient


def test_get_all_countries():
    response = CountriesClient.get_all_countries()

    assert response.status_code == 200

    data = response.json()
    assert isinstance(data, list)
    assert len(data) > 0


@pytest.mark.parametrize(
    "country_name",
    ["Ireland", "Germany", "Japan"]
)
def test_get_country_by_name(country_name):
    response = CountriesClient.get_country_by_name(country_name)

    assert response.status_code == 200

    data = response.json()
    assert isinstance(data, list)
    assert data[0]["name"]["common"] == country_name


@pytest.mark.parametrize(
    "country_code",
    ["IE", "DE", "JP"]
)
def test_get_country_by_code(country_code):
    response = CountriesClient.get_country_by_code(country_code)

    assert response.status_code == 200

    data = response.json()
    assert data["cca2"] == country_code


def test_get_country_with_invalid_name():
    response = CountriesClient.get_country_by_name("InvalidCountry123")

    assert response.status_code in [400, 404]
